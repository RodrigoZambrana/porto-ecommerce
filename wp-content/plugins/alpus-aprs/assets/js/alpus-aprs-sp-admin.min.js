!function(a){a(document).ready((function(){var s,p;s=a("#post_ID").val(),p=a(".alpus-aprs-sp-summarize-status"),setTimeout((function(){a.ajax({type:"post",data:{action:"alpus_aprs_sp_info",none:alpus_aprs_sp_admin_vars.nonce,id:s},url:alpus_aprs_sp_admin_vars.ajax_url,success:function(s){if(s.success&&(s.data.current&&p.find(".current").html(s.data.current),s.data.total&&p.find(".total").html(s.data.total),s.data.tags)){var l=s.data.tags,t=a(".alpus-aprs-sp-tags");Object.entries(l).forEach((([a,s])=>{t.append('<li class="alpus-aprs-sp-tag">'+s+"</li>")}))}}})}),200),a("body").on("click",".alpus-aprs-sp-summary-view",(function(s){var p=a("#post_ID").val(),l=a(".alpus-aprs-sp-summarize-popup"),t=a(this),i=t.html();null==window.alpus_aprs_sp_summary_loaded?(t.html(t.data("loading-text")),a.ajax({type:"post",data:{action:"alpus_aprs_sp_summary",id:p},url:alpus_aprs_sp_admin_vars.ajax_url,success:function(a){a.success&&(a.data.summary&&l.find(".alpus-aprs-sp-summary p").html(a.data.summary),a.data.pros&&l.find(".alpus-aprs-sp-pros p").html(a.data.pros),a.data.cons&&l.find(".alpus-aprs-sp-cons p").html(a.data.cons),l.addClass("show"),t.html(i),window.alpus_aprs_sp_summary_loaded=!0)}})):l.addClass("show"),s.preventDefault()})),a("body").on("click",".alpus-aprs-sp-ai-advice-view",(function(s){var p=a("#post_ID").val(),l=a(".alpus-aprs-sp-ai-advice-popup"),t=a(this),i=t.html();null==window.alpus_aprs_sp_ai_advice_loaded?(t.html(t.data("loading-text")),a.ajax({type:"post",data:{action:"alpus_aprs_sp_ai_advice",id:p},url:alpus_aprs_sp_admin_vars.ajax_url,success:function(a){a.success&&(console.log(a.data),l.find(".alpus-aprs-sp-ai-advice.general").html(a.data),l.addClass("show"),t.html(i),window.alpus_aprs_sp_ai_advice_loaded=!0)}})):l.addClass("show"),s.preventDefault()})),a("body").on("click",".alpus-aprs-popup-close",(function(s){a(".alpus-aprs-sp-summarize-popup, .alpus-aprs-sp-ai-advice-popup.show").removeClass("show"),s.preventDefault()})),a("body").on("click",".alpus-aprs-ai-question",(function(s){var p=a("#post_ID").val(),l=a(this),t=l.find("a").attr("href").slice(1),i=l.closest(".alpus-aprs-popup-wrapper").find(".alpus-aprs-sp-ai-advice."+t);$loading=i.siblings(".loading"),l.addClass("active").siblings().removeClass("active"),i.addClass("show").siblings().removeClass("show"),null==window.alpus_aprs_sp_advice&&(window.alpus_aprs_sp_advice={}),$loading.css("display",""),null==window.alpus_aprs_sp_advice[t]&&"chat"!==t&&"general"!==t&&($loading.css("display","block"),a.ajax({type:"post",data:{action:"alpus_aprs_sp_ai_detail",none:alpus_aprs_sp_admin_vars.nonce,type:t,id:p},url:alpus_aprs_sp_admin_vars.ajax_url,success:function(a){a.success&&(i.html(a.data),window.alpus_aprs_sp_advice[t]=a.data,$loading.css("display",""))}})),s.preventDefault()})),a("body").on("click",".alpus-aprs-ai-chat-send",(function(s){var p=a(this).closest(".alpus-aprs-ai-chat-wrapper"),l=p.find(".alpus-aprs-ai-chat-input"),t=p.find(".alpus-aprs-ai-chat-list"),i=l.val();t.append('<div class="alpus-aprs-ai-chat person">'+i+"</div>"),l.val(""),t.stop().animate({scrollTop:t[0].scrollHeight},200);var n=a('<div class="alpus-aprs-ai-chat ai"><div class="loading" style="display: block;"><span></span><span></span><span></span></div></div>');t.append(n),a.ajax({type:"post",data:{action:"alpus_aprs_chat_query",none:alpus_aprs_sp_admin_vars.nonce,query:i},url:alpus_aprs_sp_admin_vars.ajax_url,success:function(a){a.success&&(n.html(a.data),t.stop().animate({scrollTop:t[0].scrollHeight},300))}}),s.preventDefault()}))}))}(jQuery);